version: '3'

services:
  pulsar:
    container_name: pulsar
    image: apachepulsar/pulsar:3.1.2

    command: bin/pulsar standalone --config /pulsar/certs/standalone.conf
    ports:
      - "6650:6650"
      - "6651:6651"
      - "8080:8080"
    healthcheck:
      test: >
        sh -c "/pulsar/bin/pulsar-admin brokers healthcheck &&
               /pulsar/bin/pulsar-admin topics list public/default"
      interval: 5s
      timeout: 20s
      retries: 6
      start_period: 30s
    volumes:
      - .:/pulsar/certs
